# 项目文件结构

```
chinese-learning-platform/
├── app/
│   ├── __init__.py
│   ├── api/
│   │   ├── __init__.py
│   │   ├── stories.py
│   │   ├── scenes.py
│   │   ├── words.py
│   │   └── utils.py
│   ├── models/
│   │   ├── __init__.py
│   │   ├── story.py
│   │   ├── scene.py
│   │   ├── word.py
│   │   └── base.py
│   ├── services/
│   │   ├── __init__.py
│   │   ├── story_service.py
│   │   ├── scene_service.py
│   │   ├── word_service.py
│   │   └── deepseek_service.py
│   ├── schemas/
│   │   ├── __init__.py
│   │   ├── story_schema.py
│   │   ├── scene_schema.py
│   │   ├── word_schema.py
│   │   └── base_schema.py
│   ├── utils/
│   │   ├── __init__.py
│   │   └── json_storage.py
│   └── config.py
├── tests/
│   ├── __init__.py
│   ├── test_stories.py
│   ├── test_scenes.py
│   ├── test_words.py
│   ├── test_utils.py
│   └── test_json_storage.py
├── data/
│   ├── words.json
│   ├── scenes.json
│   └── stories.json
├── scripts/
│   ├── __init__.py
│   ├── load_data.py
│   └── generate_stories.py
├── requirements.txt
├── Dockerfile
├── docker-compose.yml
├── README.md
└── .gitignore
```

### 文件结构说明

1. **`app/`**: 主应用程序目录，包含所有核心代码。
   - **`api/`**: 包含所有API路由和控制器。
     - `stories.py`: 故事生成、升级/降级相关的API路由。
     - `scenes.py`: 场景管理相关的API路由。
     - `words.py`: 字词查询相关的API路由。
     - `utils.py`: 通用的工具函数，如错误处理、响应格式化等。
   - **`models/`**: 包含数据模型定义。
     - `story.py`: 故事数据模型。
     - `scene.py`: 场景数据模型。
     - `word.py`: 字词数据模型。
     - `base.py`: 基础数据模型，其他模型继承自此类。
   - **`services/`**: 包含业务逻辑和服务层。
     - `story_service.py`: 故事生成、升级/降级的业务逻辑。
     - `scene_service.py`: 场景管理的业务逻辑。
     - `word_service.py`: 字词查询的业务逻辑。
     - `deepseek_service.py`: 与DeepSeek API的集成逻辑。
   - **`schemas/`**: 包含数据验证和序列化模式。
     - `story_schema.py`: 故事数据的JSON Schema。
     - `scene_schema.py`: 场景数据的JSON Schema。
     - `word_schema.py`: 字词数据的JSON Schema。
     - `base_schema.py`: 基础Schema，其他Schema继承自此类。
   - **`utils/`**: 包含通用的工具类和函数。
     - `json_storage.py`: JSON 文件存储工具类，用于数据的加载和保存。
   - **`config.py`**: 应用程序配置，如API密钥、数据库连接等。

2. **`tests/`**: 单元测试和集成测试目录。
   - `test_stories.py`: 故事生成、升级/降级的测试用例。
   - `test_scenes.py`: 场景管理的测试用例。
   - `test_words.py`: 字词查询的测试用例。
   - `test_utils.py`: 工具函数的测试用例。
   - `test_json_storage.py`: JSON 存储工具的测试用例。

3. **`data/`**: 存储静态数据文件。
   - `words.json`: 字词表数据。
   - `scenes.json`: 场景数据。
   - `stories.json`: 生成的故事数据。

4. **`scripts/`**: 包含辅助脚本。
   - `load_data.py`: 用于加载初始数据到数据库或内存中。
   - `generate_stories.py`: 用于批量生成故事的脚本。

5. **`requirements.txt`**: 项目依赖的Python包列表。

6. **`Dockerfile`**: 用于构建Docker镜像。

7. **`docker-compose.yml`**: 用于定义和运行多容器Docker应用程序。

8. **`README.md`**: 项目说明文档，包含项目概述、安装步骤、使用方法等。

9. **`.gitignore`**: 指定哪些文件或目录应被Git忽略。

### 模块化设计说明

- **API路由**：API路由模块负责处理HTTP请求，调用相应的服务层逻辑，并返回响应。每个功能模块（如故事、场景、字词）都有独立的API路由文件。
  
- **服务层**：服务层包含核心业务逻辑，负责处理数据操作、调用外部API（如DeepSeek API）等。服务层与数据模型和API路由解耦，便于单独测试和维护。

- **数据模型**：数据模型定义了应用程序中的数据结构，如故事、场景、字词等。每个模型对应一个Python类，负责数据的存储和操作。

- **数据验证**：使用JSON Schema对请求和响应数据进行验证，确保数据的完整性和一致性。

- **数据存储**：通过 `utils/json_storage.py` 实现JSON文件的读写操作，确保数据可以持久化。

- **测试**：每个功能模块都有对应的测试文件，确保代码的正确性和稳定性。

- **脚本**：辅助脚本用于数据加载、批量生成故事等操作，便于开发和维护。

### 总结

该文件结构设计遵循了模块化、分层架构的原则，确保代码的可维护性和可扩展性。每个功能模块（如故事、场景、字词）都有独立的API路由、服务层、数据模型和测试文件，便于团队协作和后续功能扩展。
```
